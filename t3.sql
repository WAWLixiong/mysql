-- ================================================


update m set d=d+1 where id=10; -- 不阻塞


-- --------------------------------------------------



update t set d=d+1 where id=10; -- 不阻塞

-- --------------------------------------------------
-- ================================================

-- 非唯一索引等值锁 ================================================



insert into m values(7, 7, 7); -- 阻塞
insert into m values(7, 0, 7); -- 阻塞
insert into m values(7, -1, 7); -- 不阻塞
insert into m values(7, 10, 7); -- 阻塞
insert into m values(7, 11, 7); -- 不阻塞

-- --------------------------------------------------



insert into t values(7, 7, 7); -- 阻塞
insert into t values(7, 0, 7); -- 阻塞
insert into t values(7, -1, 7); -- 不阻塞
insert into t values(7, 10, 7); -- 阻塞
insert into t values(7, 11, 7); -- 不阻塞

-- 非唯一索引等值锁 ================================================
-- 主键索引范围锁 ================================================




update m set d=d+1 where id=15; -- 阻塞

-- --------------------------------------------------




update t set d=d+1 where id=15; -- 阻塞

-- 主键索引范围锁 ================================================
-- 非唯一索引范围锁 ================================================



update m set d=d+1 where c=15; -- 阻塞

-- --------------------------------------------------



update t set d=d+1 where c=15; -- 阻塞

-- 非唯一索引范围锁 ================================================
-- 唯一索引范围锁 bug ================================================



insert into m values(16, 16, 16); -- 阻塞

-- --------------------------------------------------



insert into t values(16, 16, 16); -- 阻塞

-- 唯一索引范围锁 bug ================================================
-- 非唯一索引上存在"等值"的例子 ================================================




update m set d=d+1 where c=15; -- 不阻塞

-- --------------------------------------------------




update t set d=d+1 where c=15; -- 不阻塞

-- 非唯一索引上存在"等值"的例子 ================================================
-- limit 语句加锁 ================================================





-- --------------------------------------------------





-- limit 语句加锁 ================================================
-- 死锁的例子 ================================================












-- 死锁的例子 ================================================
